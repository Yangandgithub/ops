{% extends 'index.html' %}
{% block page-content %}
    <style>
        label.control-label {
            font-size: 16px;
        }

        #formAdd .btn-group.bootstrap-select button,
        .form-control {
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
        }

        @media (max-width: 768px) {
            #formAdd .btn-group.bootstrap-select {
                width: 100%;
            }
        }
    </style>
    <div id="page-wrapper" style="margin-top: 40px">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <i class="fa fa-database"></i>&nbsp;业务平台明细
                    </div>
                    <!-- /.panel-heading -->
                    <div class="panel-body">
                        <form id="formAdd" class="form-horizontal"> {% csrf_token %}
                            <div class="form-group">
                                <label for="platform_name" class="col-lg-2 col-sm-2 control-label">业务平台名称<span
                                        style="color:red;"> *</span></label>
                                <div class="col-lg-3 col-sm-4">
                                    <input type="text" class="form-control" data-toggle="tooltip" id="platform_name"
                                           name="platform_name">
                                </div>
                                <label for="platform_desc" class="col-lg-2 col-sm-2 control-label">业务平台详情<span
                                        style="color:red;"> *</span></label>
                                <div class="col-lg-3 col-sm-4">
                                    <input type="text" class="form-control" id="platform_desc" name="platform_desc">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-12 text-center">
                                    <button type="button" class="btn btn-default" onclick="cancelClick()"
                                            style="margin-right:20px">取消
                                    </button>
                                    <button id="btn-submit" type="button" class="btn btn-primary"
                                            style="margin-left:20px">提交
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <!-- /.panel-body -->
                </div>
                <!-- /.panel -->
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("[data-toggle='tooltip']").tooltip();


            //提交按钮
            $("#btn-submit").click(function () {
                if ($("#platform_name").val() == '') {
                    window.wxc.xcConfirm("请输入平台名称", window.wxc.xcConfirm.typeEnum.error);
                    return;
                }
                $.ajax({
                    "type": "post",
                    "url": "/asset/platform/add/",
                    "dataType": "json",
                    "data": {
                        "platform_name": $("#platform_name").val(),
                        "platform_desc": $("#platform_desc").val()
                    },
                    "success": function (resp) {
                        location.href = '/asset/platform/'
                    },
                    "error": function (response) {
                        window.wxc.xcConfirm("操作失败!", window.wxc.xcConfirm.typeEnum.error);
                    }
                });
            });
        });

        function inventoryValidator() {
            $('#formAdd').bootstrapValidator({
                message: 'This value is not valid',
                feedbackIcons: {
                    valid: 'glyphicon glyphicon-ok',
                    invalid: 'glyphicon glyphicon-remove',
                    validating: 'glyphicon glyphicon-refresh'
                },
                fields: {
                    device_id: {
                        message: '系统权限名验证失败',
                        validators: {
                            notEmpty: {
                                message: '设备编码不能为空'
                            }
                        }
                    },
                    platform_id: {
                        validators: {
                            notEmpty: {
                                message: '所属平台不能为空'
                            }
                        }
                    },
                    ansible_ssh_host: {
                        validators: {
                            notEmpty: {
                                message: '服务器IP不能为空'
                            }
                        }
                    },
                    ansible_ssh_user: {
                        validators: {
                            notEmpty: {
                                message: '服务器用户不能为空'
                            }
                        }
                    },
                    ansible_ssh_port: {
                        validators: {
                            notEmpty: {
                                message: '服务器端口不能为空'
                            }
                        }
                    }
                }
            });

        }

        function cancelClick() {
            location.href = '/asset/platform/'
        }
    </script>
{% endblock %}
